import{i as e}from"./index-CVOPyXAZ.js";function d(){return!!e()}async function w(r){const a=e();if(!a)throw new Error("خطأ في الإعدادات: Supabase غير مُفعّل على السيرفر");const i=Math.max(10,Math.min(25,Math.floor(r.questionCount??10))),{data:s,error:c}=await a.functions.invoke("generate-study-content",{body:{action:"study_pack",text:r.text,questionCount:i}});if(c)throw new Error("فشل الاتصال بمركز الذكاء الاصطناعي");const n=s;if(!n?.analysis_markdown||!Array.isArray(n.questions))throw new Error("فشل الاتصال بمركز الذكاء الاصطناعي");const u=n.questions.slice(0,i).map(o=>{const t=o&&typeof o=="object"?o:{},m=String(t.skill||""),l=Array.isArray(t.options)?t.options:[];return{type:"mcq",skill:m==="التطبيق"?"التطبيق":"الفهم",question:String(t.question||"").trim(),options:l.map(p=>String(p)),correctIndex:Math.max(0,Math.min(3,Number(t.correctIndex??0))),explanation:String(t.explanation||"").trim()}});return{analysis_markdown:String(n.analysis_markdown||"").trim(),questions:u}}export{w as a,d as g};
